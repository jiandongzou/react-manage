import{c as K,e as M,d as Q,h as P,a as I,b as q}from"./@babel-9367d27f.js";import{r as o}from"./react-16261f20.js";import{r as F}from"./react-dom-c85821af.js";import{a as W}from"./rc-motion-66270194.js";import{c as L}from"./classnames-f3eb6505.js";import{K as z}from"./rc-util-8ac52126.js";var B=o.forwardRef(function(e,y){var C=e.prefixCls,c=e.style,m=e.className,u=e.duration,s=u===void 0?4.5:u,E=e.eventKey,p=e.content,k=e.closable,A=e.closeIcon,S=A===void 0?"x":A,h=e.props,_=e.onClick,v=e.onNoticeClose,b=e.times,$=o.useState(!1),f=K($,2),d=f[0],g=f[1],N=function(){v(E)},l=function(r){(r.key==="Enter"||r.code==="Enter"||r.keyCode===z.ENTER)&&N()};o.useEffect(function(){if(!d&&s>0){var n=setTimeout(function(){N()},s*1e3);return function(){clearTimeout(n)}}},[s,d,b]);var t="".concat(C,"-notice");return o.createElement("div",M({},h,{ref:y,className:L(t,m,Q({},"".concat(t,"-closable"),k)),style:c,onMouseEnter:function(){g(!0)},onMouseLeave:function(){g(!1)},onClick:_}),o.createElement("div",{className:"".concat(t,"-content")},p),k&&o.createElement("a",{tabIndex:0,className:"".concat(t,"-close"),onKeyDown:l,onClick:function(r){r.preventDefault(),r.stopPropagation(),N()}},S))}),J=o.forwardRef(function(e,y){var C=e.prefixCls,c=C===void 0?"rc-notification":C,m=e.container,u=e.motion,s=e.maxCount,E=e.className,p=e.style,k=e.onAllRemoved,A=o.useState([]),S=K(A,2),h=S[0],_=S[1],v=function(n){var r,a=h.find(function(i){return i.key===n});a==null||(r=a.onClose)===null||r===void 0||r.call(a),_(function(i){return i.filter(function(x){return x.key!==n})})};o.useImperativeHandle(y,function(){return{open:function(n){_(function(r){var a=P(r),i=a.findIndex(function(w){return w.key===n.key}),x=I({},n);if(i>=0){var R;x.times=(((R=r[i])===null||R===void 0?void 0:R.times)||0)+1,a[i]=x}else x.times=0,a.push(x);return s>0&&a.length>s&&(a=a.slice(-s)),a})},close:function(n){v(n)},destroy:function(){_([])}}});var b=o.useState({}),$=K(b,2),f=$[0],d=$[1];o.useEffect(function(){var t={};h.forEach(function(n){var r=n.placement,a=r===void 0?"topRight":r;a&&(t[a]=t[a]||[],t[a].push(n))}),Object.keys(f).forEach(function(n){t[n]=t[n]||[]}),d(t)},[h]);var g=function(n){d(function(r){var a=I({},r),i=a[n]||[];return i.length||delete a[n],a})},N=o.useRef(!1);if(o.useEffect(function(){Object.keys(f).length>0?N.current=!0:N.current&&(k==null||k(),N.current=!1)},[f]),!m)return null;var l=Object.keys(f);return F.createPortal(o.createElement(o.Fragment,null,l.map(function(t){var n=f[t],r=n.map(function(i){return{config:i,key:i.key}}),a=typeof u=="function"?u(t):u;return o.createElement(W,M({key:t,className:L(c,"".concat(c,"-").concat(t),E==null?void 0:E(t)),style:p==null?void 0:p(t),keys:r,motionAppear:!0},a,{onAllRemoved:function(){g(t)}}),function(i,x){var R=i.config,w=i.className,O=i.style,D=R.key,j=R.times,H=R.className,G=R.style;return o.createElement(B,M({},R,{ref:x,prefixCls:c,className:L(w,H),style:I(I({},O),G),times:j,key:D,eventKey:D,onNoticeClose:v}))})})),m)}),U=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved"],V=function(){return document.body},T=0;function X(){for(var e={},y=arguments.length,C=new Array(y),c=0;c<y;c++)C[c]=arguments[c];return C.forEach(function(m){m&&Object.keys(m).forEach(function(u){var s=m[u];s!==void 0&&(e[u]=s)})}),e}function ae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=e.getContainer,C=y===void 0?V:y,c=e.motion,m=e.prefixCls,u=e.maxCount,s=e.className,E=e.style,p=e.onAllRemoved,k=q(e,U),A=o.useState(),S=K(A,2),h=S[0],_=S[1],v=o.useRef(),b=o.createElement(J,{container:h,ref:v,prefixCls:m,motion:c,maxCount:u,className:s,style:E,onAllRemoved:p}),$=o.useState([]),f=K($,2),d=f[0],g=f[1],N=o.useMemo(function(){return{open:function(t){var n=X(k,t);(n.key===null||n.key===void 0)&&(n.key="rc-notification-".concat(T),T+=1),g(function(r){return[].concat(P(r),[{type:"open",config:n}])})},close:function(t){g(function(n){return[].concat(P(n),[{type:"close",key:t}])})},destroy:function(){g(function(t){return[].concat(P(t),[{type:"destroy"}])})}}},[]);return o.useEffect(function(){_(C())}),o.useEffect(function(){v.current&&d.length&&(d.forEach(function(l){switch(l.type){case"open":v.current.open(l.config);break;case"close":v.current.close(l.key);break;case"destroy":v.current.destroy();break}}),g(function(l){return l.filter(function(t){return!d.includes(t)})}))},[d]),[N,b]}export{B as N,ae as u};
