import{K as ie,B as We}from"./rc-util-8ac52126.js";import{h as Q,a as ve,d as W,_ as Ue,c as ue,e as je,b as sn}from"./@babel-9367d27f.js";import{u as De,b as dn,B as vn}from"./rc-select-d03dfa8d.js";import{r as t}from"./react-16261f20.js";import{c as fn,d as Re}from"./rc-tree-6e351d8e.js";import{c as Ke}from"./classnames-f3eb6505.js";import"./react-is-e8e5dbb3.js";var _e=t.createContext(null),be="__rc_cascader_search_mark__",hn=function(n,a,r){var o=r.label;return a.some(function(l){return String(l[o]).toLowerCase().includes(n.toLowerCase())})},pn=function(n,a,r,o){return a.map(function(l){return l[o.label]}).join(" / ")};const mn=function(e,n,a,r,o,l){var u=o.filter,s=u===void 0?hn:u,d=o.render,c=d===void 0?pn:d,x=o.limit,g=x===void 0?50:x,P=o.sort;return t.useMemo(function(){var C=[];if(!e)return[];function p(k,v){k.forEach(function(V){if(!(!P&&g>0&&C.length>=g)){var L=[].concat(Q(v),[V]),q=V[a.children];if((!q||q.length===0||l)&&s(e,L,{label:a.label})){var f;C.push(ve(ve({},V),{},(f={},W(f,a.label,c(e,L,r,a)),W(f,be,L),W(f,a.children,void 0),f)))}q&&p(V[a.children],L)}})}return p(n,[]),P&&C.sort(function(k,v){return P(k[be],v[be],e,a)}),g>0?C.slice(0,g):C},[e,n,a,r,c,l,s,P,g])};var Te="__RC_CASCADER_SPLIT__",Xe="SHOW_PARENT",qe="SHOW_CHILD";function Z(e){return e.join(Te)}function Ce(e){return e.map(Z)}function gn(e){return e.split(Te)}function Cn(e){var n=e||{},a=n.label,r=n.value,o=n.children,l=r||"value";return{label:a||"label",value:l,key:l,children:o||"children"}}function Pe(e,n){var a,r;return(a=e.isLeaf)!==null&&a!==void 0?a:!((r=e[n.children])!==null&&r!==void 0&&r.length)}function bn(e){var n=e.parentElement;if(n){var a=e.offsetTop-n.offsetTop;a-n.scrollTop<0?n.scrollTo({top:a}):a+e.offsetHeight-n.scrollTop>n.offsetHeight&&n.scrollTo({top:a+e.offsetHeight-n.offsetHeight})}}function Ge(e,n){return e.map(function(a){var r;return(r=a[be])===null||r===void 0?void 0:r.map(function(o){return o[n.value]})})}function He(e,n,a){var r=new Set(e),o=n();return e.filter(function(l){var u=o[l],s=u?u.parent:null,d=u?u.children:null;return a===qe?!(d&&d.some(function(c){return c.key&&r.has(c.key)})):!(s&&!s.node.disabled&&r.has(s.key))})}function Ve(e,n,a){for(var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=n,l=[],u=function(){var c,x,g,P=e[s],C=(c=o)===null||c===void 0?void 0:c.findIndex(function(k){var v=k[a.value];return r?String(v)===String(P):v===P}),p=C!==-1?(x=o)===null||x===void 0?void 0:x[C]:null;l.push({value:(g=p==null?void 0:p[a.value])!==null&&g!==void 0?g:P,index:C,option:p}),o=p==null?void 0:p[a.children]},s=0;s<e.length;s+=1)u();return l}const Sn=function(e,n,a,r,o){return t.useMemo(function(){var l=o||function(u){var s=r?u.slice(-1):u,d=" / ";return s.every(function(c){return["string","number"].includes(Ue(c))})?s.join(d):s.reduce(function(c,x,g){var P=t.isValidElement(x)?t.cloneElement(x,{key:g}):x;return g===0?[P]:[].concat(Q(c),[d,P])},[])};return e.map(function(u){var s,d,c=Ve(u,n,a),x=l(c.map(function(P){var C,p=P.option,k=P.value;return(C=p==null?void 0:p[a.label])!==null&&C!==void 0?C:k}),c.map(function(P){var C=P.option;return C})),g=Z(u);return{label:x,value:g,key:g,valueCells:u,disabled:(s=c[c.length-1])===null||s===void 0||(d=s.option)===null||d===void 0?void 0:d.disabled}})},[e,n,a,o,r])},kn=function(e,n){var a=t.useRef({options:null,info:null}),r=t.useCallback(function(){return a.current.options!==e&&(a.current.options=e,a.current.info=fn(e,{fieldNames:n,initWrapper:function(l){return ve(ve({},l),{},{pathKeyEntities:{}})},processEntity:function(l,u){var s=l.nodes.map(function(d){return d[n.value]}).join(Te);u.pathKeyEntities[s]=l,l.key=s}})),a.current.info.pathKeyEntities},[n,e]);return r},yn=function(e,n){return t.useCallback(function(a){var r=[],o=[];return a.forEach(function(l){var u=Ve(l,e,n);u.every(function(s){return s.option})?o.push(l):r.push(l)}),[o,r]},[e,n])};function Fe(e){var n=t.useRef();n.current=e;var a=t.useCallback(function(){return n.current.apply(n,arguments)},[]);return a}function xn(e){return t.useMemo(function(){if(!e)return[!1,{}];var n={matchInputWidth:!0,limit:50};return e&&Ue(e)==="object"&&(n=ve(ve({},n),e)),n.limit<=0&&delete n.limit,[!0,n]},[e])}var Pn=t.memo(function(e){var n=e.children;return n},function(e,n){return!n.open});function Vn(e){var n,a=e.prefixCls,r=e.checked,o=e.halfChecked,l=e.disabled,u=e.onClick,s=e.disableCheckbox,d=t.useContext(_e),c=d.checkable,x=typeof c!="boolean"?c:null;return t.createElement("span",{className:Ke("".concat(a),(n={},W(n,"".concat(a,"-checked"),r),W(n,"".concat(a,"-indeterminate"),!r&&o),W(n,"".concat(a,"-disabled"),l||s),n)),onClick:u},x)}var Je="__cascader_fix_label__";function _n(e){var n=e.prefixCls,a=e.multiple,r=e.options,o=e.activeValue,l=e.prevValuePath,u=e.onToggleOpen,s=e.onSelect,d=e.onActive,c=e.checkedSet,x=e.halfCheckedSet,g=e.loadingKeys,P=e.isSelectable,C=e.searchValue,p="".concat(n,"-menu"),k="".concat(n,"-menu-item"),v=t.useContext(_e),V=v.fieldNames,L=v.changeOnSelect,q=v.expandTrigger,f=v.expandIcon,ee=v.loadingIcon,A=v.dropdownMenuColumnStyle,b=q==="hover",O=t.useMemo(function(){return r.map(function(i){var S,h=i.disabled,R=i.disableCheckbox,H=i[be],I=(S=i[Je])!==null&&S!==void 0?S:i[V.label],$=i[V.value],B=Pe(i,V),re=H?H.map(function(F){return F[V.value]}):[].concat(Q(l),[$]),D=Z(re),U=g.includes(D),G=c.has(D),_=x.has(D);return{disabled:h,label:I,value:$,isLeaf:B,isLoading:U,checked:G,halfChecked:_,option:i,disableCheckbox:R,fullPath:re,fullPathKey:D}})},[r,c,V,x,g,l]);return t.createElement("ul",{className:p,role:"menu"},O.map(function(i){var S,h=i.disabled,R=i.label,H=i.value,I=i.isLeaf,$=i.isLoading,B=i.checked,re=i.halfChecked,D=i.option,U=i.fullPath,G=i.fullPathKey,_=i.disableCheckbox,F=function(){if(!(h||C)){var X=Q(U);b&&I&&X.pop(),d(X)}},fe=function(){P(D)&&s(U,I)},oe;return typeof D.title=="string"?oe=D.title:typeof R=="string"&&(oe=R),t.createElement("li",{key:G,className:Ke(k,(S={},W(S,"".concat(k,"-expand"),!I),W(S,"".concat(k,"-active"),o===H||o===G),W(S,"".concat(k,"-disabled"),h),W(S,"".concat(k,"-loading"),$),S)),style:A,role:"menuitemcheckbox",title:oe,"aria-checked":B,"data-path-key":G,onClick:function(){F(),!_&&(!a||I)&&fe()},onDoubleClick:function(){L&&u(!1)},onMouseEnter:function(){b&&F()},onMouseDown:function(X){X.preventDefault()}},a&&t.createElement(Vn,{prefixCls:"".concat(n,"-checkbox"),checked:B,halfChecked:re,disabled:h||_,disableCheckbox:_,onClick:function(X){_||(X.stopPropagation(),fe())}}),t.createElement("div",{className:"".concat(k,"-content")},R),!$&&f&&!I&&t.createElement("div",{className:"".concat(k,"-expand-icon")},f),$&&ee&&t.createElement("div",{className:"".concat(k,"-loading-icon")},ee))}))}const On=function(){var e=De(),n=e.multiple,a=e.open,r=t.useContext(_e),o=r.values,l=t.useState([]),u=ue(l,2),s=u[0],d=u[1];return t.useEffect(function(){if(a&&!n){var c=o[0];d(c||[])}},[a]),[s,d]},En=function(e,n,a,r,o,l){var u=De(),s=u.direction,d=u.searchValue,c=u.toggleOpen,x=u.open,g=s==="rtl",P=t.useMemo(function(){for(var A=-1,b=n,O=[],i=[],S=r.length,h=Ge(n,a),R=function(D){var U=b.findIndex(function(G,_){return(h[_]?Z(h[_]):G[a.value])===r[D]});if(U===-1)return"break";A=U,O.push(A),i.push(r[D]),b=b[A][a.children]},H=0;H<S&&b;H+=1){var I=R(H);if(I==="break")break}for(var $=n,B=0;B<O.length-1;B+=1)$=$[O[B]][a.children];return[i,A,$,h]},[r,a,n]),C=ue(P,4),p=C[0],k=C[1],v=C[2],V=C[3],L=function(b){o(b)},q=function(b){var O=v.length,i=k;i===-1&&b<0&&(i=O);for(var S=0;S<O;S+=1){i=(i+b+O)%O;var h=v[i];if(h&&!h.disabled){var R=p.slice(0,-1).concat(V[i]?Z(V[i]):h[a.value]);L(R);return}}},f=function(){if(p.length>1){var b=p.slice(0,-1);L(b)}else c(!1)},ee=function(){var b,O=((b=v[k])===null||b===void 0?void 0:b[a.children])||[],i=O.find(function(h){return!h.disabled});if(i){var S=[].concat(Q(p),[i[a.value]]);L(S)}};t.useImperativeHandle(e,function(){return{onKeyDown:function(b){var O=b.which;switch(O){case ie.UP:case ie.DOWN:{var i=0;O===ie.UP?i=-1:O===ie.DOWN&&(i=1),i!==0&&q(i);break}case ie.LEFT:{if(d)break;g?ee():f();break}case ie.RIGHT:{if(d)break;g?f():ee();break}case ie.BACKSPACE:{d||f();break}case ie.ENTER:{if(p.length){var S=v[k],h=(S==null?void 0:S[be])||[];h.length?l(h.map(function(R){return R[a.value]}),h[h.length-1]):l(p,v[k])}break}case ie.ESC:c(!1),x&&b.stopPropagation()}},onKeyUp:function(){}}})};var wn=t.forwardRef(function(e,n){var a,r,o,l,u=De(),s=u.prefixCls,d=u.multiple,c=u.searchValue,x=u.toggleOpen,g=u.notFoundContent,P=u.direction,C=u.open,p=t.useRef(),k=P==="rtl",v=t.useContext(_e),V=v.options,L=v.values,q=v.halfValues,f=v.fieldNames,ee=v.changeOnSelect,A=v.onSelect,b=v.searchOptions,O=v.dropdownPrefixCls,i=v.loadData,S=v.expandTrigger,h=O||s,R=t.useState([]),H=ue(R,2),I=H[0],$=H[1],B=function(m){if(!(!i||c)){var E=Ve(m,V,f),w=E.map(function(se){var me=se.option;return me}),N=w[w.length-1];if(N&&!Pe(N,f)){var ae=Z(m);$(function(se){return[].concat(Q(se),[ae])}),i(w)}}};t.useEffect(function(){I.length&&I.forEach(function(M){var m=gn(M),E=Ve(m,V,f,!0).map(function(N){var ae=N.option;return ae}),w=E[E.length-1];(!w||w[f.children]||Pe(w,f))&&$(function(N){return N.filter(function(ae){return ae!==M})})})},[V,I,f]);var re=t.useMemo(function(){return new Set(Ce(L))},[L]),D=t.useMemo(function(){return new Set(Ce(q))},[q]),U=On(),G=ue(U,2),_=G[0],F=G[1],fe=function(m){F(m),B(m)},oe=function(m){var E=m.disabled,w=Pe(m,f);return!E&&(w||ee||d)},j=function(m,E){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;A(m),!d&&(E||ee&&(S==="hover"||w))&&x(!1)},X=t.useMemo(function(){return c?b:V},[c,b,V]),J=t.useMemo(function(){for(var M=[{options:X}],m=X,E=Ge(m,f),w=function(){var me=_[N],Se=m.find(function(de,ge){return(E[ge]?Z(E[ge]):de[f.value])===me}),le=Se==null?void 0:Se[f.children];if(!(le!=null&&le.length))return"break";m=le,M.push({options:le})},N=0;N<_.length;N+=1){var ae=w();if(ae==="break")break}return M},[X,_,f]),ne=function(m,E){oe(E)&&j(m,Pe(E,f),!0)};En(n,X,f,_,fe,ne),t.useEffect(function(){for(var M=0;M<_.length;M+=1){var m,E=_.slice(0,M+1),w=Z(E),N=(m=p.current)===null||m===void 0?void 0:m.querySelector('li[data-path-key="'.concat(w.replace(/\\{0,2}"/g,'\\"'),'"]'));N&&bn(N)}},[_]);var Y=!((a=J[0])!==null&&a!==void 0&&(r=a.options)!==null&&r!==void 0&&r.length),ce=[(o={},W(o,f.value,"__EMPTY__"),W(o,Je,g),W(o,"disabled",!0),o)],Me=ve(ve({},e),{},{multiple:!Y&&d,onSelect:j,onActive:fe,onToggleOpen:x,checkedSet:re,halfCheckedSet:D,loadingKeys:I,isSelectable:oe}),Oe=Y?[{options:ce}]:J,pe=Oe.map(function(M,m){var E=_.slice(0,m),w=_[m];return t.createElement(_n,je({key:m},Me,{searchValue:c,prefixCls:h,options:M.options,prevValuePath:E,activeValue:w}))});return t.createElement(Pn,{open:C},t.createElement("div",{className:Ke("".concat(h,"-menus"),(l={},W(l,"".concat(h,"-menu-empty"),Y),W(l,"".concat(h,"-rtl"),k),l)),ref:p},pe))}),Mn=["id","prefixCls","fieldNames","defaultValue","value","changeOnSelect","onChange","displayRender","checkable","searchValue","onSearch","showSearch","expandTrigger","options","dropdownPrefixCls","loadData","popupVisible","open","popupClassName","dropdownClassName","dropdownMenuColumnStyle","popupPlacement","placement","onDropdownVisibleChange","onPopupVisibleChange","expandIcon","loadingIcon","children","dropdownMatchSelectWidth","showCheckedStrategy"];function In(e){return Array.isArray(e)&&Array.isArray(e[0])}function Be(e){return e?In(e)?e:(e.length===0?[]:[e]).map(function(n){return Array.isArray(n)?n:[n]}):[]}var Ye=t.forwardRef(function(e,n){var a=e.id,r=e.prefixCls,o=r===void 0?"rc-cascader":r,l=e.fieldNames,u=e.defaultValue,s=e.value,d=e.changeOnSelect,c=e.onChange,x=e.displayRender,g=e.checkable,P=e.searchValue,C=e.onSearch,p=e.showSearch,k=e.expandTrigger,v=e.options,V=e.dropdownPrefixCls,L=e.loadData,q=e.popupVisible,f=e.open,ee=e.popupClassName,A=e.dropdownClassName,b=e.dropdownMenuColumnStyle,O=e.popupPlacement,i=e.placement,S=e.onDropdownVisibleChange,h=e.onPopupVisibleChange,R=e.expandIcon,H=R===void 0?">":R,I=e.loadingIcon,$=e.children,B=e.dropdownMatchSelectWidth,re=B===void 0?!1:B,D=e.showCheckedStrategy,U=D===void 0?Xe:D,G=sn(e,Mn),_=dn(a),F=!!g,fe=We(u,{value:s,postState:Be}),oe=ue(fe,2),j=oe[0],X=oe[1],J=t.useMemo(function(){return Cn(l)},[JSON.stringify(l)]),ne=t.useMemo(function(){return v||[]},[v]),Y=kn(ne,J),ce=t.useCallback(function(K){var y=Y();return K.map(function(T){var te=y[T].nodes;return te.map(function(z){return z[J.value]})})},[Y,J]),Me=We("",{value:P,postState:function(y){return y||""}}),Oe=ue(Me,2),pe=Oe[0],M=Oe[1],m=function(y,T){M(y),T.source!=="blur"&&C&&C(y)},E=xn(p),w=ue(E,2),N=w[0],ae=w[1],se=mn(pe,ne,J,V||o,ae,d),me=yn(ne,J),Se=t.useMemo(function(){var K=me(j),y=ue(K,2),T=y[0],te=y[1];if(!F||!j.length)return[T,[],te];var z=Ce(T),ye=Y(),he=Re(z,!0,ye),Ee=he.checkedKeys,we=he.halfCheckedKeys;return[ce(Ee),ce(we),te]},[F,j,Y,ce,me]),le=ue(Se,3),de=le[0],ge=le[1],ke=le[2],ze=t.useMemo(function(){var K=Ce(de),y=He(K,Y,U);return[].concat(Q(ke),Q(ce(y)))},[de,Y,ce,ke,U]),Qe=Sn(ze,ne,J,F,x),Ie=Fe(function(K){if(X(K),c){var y=Be(K),T=y.map(function(ye){return Ve(ye,ne,J).map(function(he){return he.option})}),te=F?y:y[0],z=F?T:T[0];c(te,z)}}),Le=Fe(function(K){if(M(""),!F)Ie(K);else{var y=Z(K),T=Ce(de),te=Ce(ge),z=T.includes(y),ye=ke.some(function(xe){return Z(xe)===y}),he=de,Ee=ke;if(ye&&!z)Ee=ke.filter(function(xe){return Z(xe)!==y});else{var we=z?T.filter(function(xe){return xe!==y}):[].concat(Q(T),[y]),Ne=Y(),Ae;if(z){var ln=Re(we,{checked:!1,halfCheckedKeys:te},Ne);Ae=ln.checkedKeys}else{var un=Re(we,!0,Ne);Ae=un.checkedKeys}var cn=He(Ae,Y,U);he=ce(cn)}Ie([].concat(Q(Ee),Q(he)))}}),Ze=function(y,T){if(T.type==="clear"){Ie([]);return}var te=T.values[0],z=te.valueCells;Le(z)},en=f!==void 0?f:q,nn=A||ee,an=i||O,tn=function(y){S==null||S(y),h==null||h(y)},rn=t.useMemo(function(){return{options:ne,fieldNames:J,values:de,halfValues:ge,changeOnSelect:d,onSelect:Le,checkable:g,searchOptions:se,dropdownPrefixCls:V,loadData:L,expandTrigger:k,expandIcon:H,loadingIcon:I,dropdownMenuColumnStyle:b}},[ne,J,de,ge,d,Le,g,se,V,L,k,H,I,b]),$e=!(pe?se:ne).length,on=pe&&ae.matchInputWidth||$e?{}:{minWidth:"auto"};return t.createElement(_e.Provider,{value:rn},t.createElement(vn,je({},G,{ref:n,id:_,prefixCls:o,dropdownMatchSelectWidth:re,dropdownStyle:on,displayValues:Qe,onDisplayValuesChange:Ze,mode:F?"multiple":void 0,searchValue:pe,onSearch:m,showSearch:N,OptionList:wn,emptyOptions:$e,open:en,dropdownClassName:nn,placement:an,onDropdownVisibleChange:tn,getRawInputElement:function(){return $}})))});Ye.SHOW_PARENT=Xe;Ye.SHOW_CHILD=qe;export{Ye as C};
